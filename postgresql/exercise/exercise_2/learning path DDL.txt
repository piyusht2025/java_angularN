CREATE TABLE emp_details (
    emp_id INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    emp_name VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE,
    department VARCHAR(100),
    is_active BOOLEAN DEFAULT TRUE CHECK ( is_active IN(TRUE,FALSE)),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_by INT,
    updated_at TIMESTAMP,
    updated_by INT,
    FOREIGN KEY (created_by) REFERENCES emp_details(emp_id),
    FOREIGN KEY (updated_by) REFERENCES emp_details(emp_id)


);

CREATE TABLE courses (
    course_id INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    course_name VARCHAR(100) NOT NULL,
    created_date DATE NOT NULL,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_by INT,
    updated_at TIMESTAMP,
    updated_by INT,
    FOREIGN KEY (created_by) REFERENCES emp_details(emp_id),
    FOREIGN KEY (updated_by) REFERENCES emp_details(emp_id)
);

CREATE TABLE emp_course (
    emp_id INT NOT NULL,
    course_id INT NOT NULL,
    progress INT CHECK (progress BETWEEN 0 AND 100),
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_by INT,
    updated_at TIMESTAMP,
    updated_by INT,
    PRIMARY KEY (emp_id, course_id),
    FOREIGN KEY (emp_id) REFERENCES emp_details(emp_id),
    FOREIGN KEY (course_id) REFERENCES Courses(course_id),
    FOREIGN KEY (created_by) REFERENCES emp_details(emp_id),
    FOREIGN KEY (updated_by) REFERENCES emp_details(emp_id)
);

CREATE TABLE chapter (
    chap_id INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    chap_name VARCHAR(100) NOT NULL,
    chap_desc VARCHAR(200) NOT NULL,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_by INT,
    updated_at TIMESTAMP,
    updated_by INT,
    FOREIGN KEY (created_by) REFERENCES emp_details(emp_id),
    FOREIGN KEY (updated_by) REFERENCES emp_details(emp_id)
);

CREATE TABLE course_chapter (
    course_id INT NOT NULL,
    chap_id INT NOT NULL,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_by INT,
    updated_at TIMESTAMP,
    updated_by INT,
    PRIMARY KEY (course_id, chap_id),
    FOREIGN KEY (course_id) REFERENCES Courses(course_id),
    FOREIGN KEY (chap_id) REFERENCES chapter(chap_id),
    FOREIGN KEY (created_by) REFERENCES emp_details(emp_id),
    FOREIGN KEY (updated_by) REFERENCES emp_details(emp_id)
);

CREATE TABLE video (
    vid_id INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    vid_duration INTERVAL NOT NULL,
    chap_id INT NOT NULL,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_by INT,
    updated_at TIMESTAMP,
    updated_by INT,
    FOREIGN KEY (chap_id) REFERENCES chapter(chap_id),
   FOREIGN KEY (created_by) REFERENCES emp_details(emp_id),
    FOREIGN KEY (updated_by) REFERENCES emp_details(emp_id)
);

CREATE TABLE user_notes (
    note_id INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    emp_id INT NOT NULL,
    vid_id INT NOT NULL,
    note_text TEXT NOT NULL,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_by INT,
    updated_at TIMESTAMP,
    updated_by INT,
    FOREIGN KEY (emp_id) REFERENCES emp_details(emp_id),
    FOREIGN KEY (vid_id) REFERENCES video(vid_id),
    FOREIGN KEY (created_by) REFERENCES emp_details(emp_id),
    FOREIGN KEY (updated_by) REFERENCES emp_details(emp_id)
);

CREATE TABLE attachment (
    att_id INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    att_name VARCHAR(255) NOT NULL,
    vid_id INT NOT NULL,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_by INT,
    updated_at TIMESTAMP,
    updated_by INT,
    FOREIGN KEY (vid_id) REFERENCES video(vid_id),
    FOREIGN KEY (created_by) REFERENCES emp_details(emp_id),
    FOREIGN KEY (updated_by) REFERENCES emp_details(emp_id)
);

CREATE TABLE video_comments (
    com_id INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    com_desc TEXT NOT NULL,
    vid_id INT NOT NULL,
    emp_id INT NOT NULL,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_by INT,
    updated_at TIMESTAMP,
    updated_by INT,
    FOREIGN KEY (vid_id) REFERENCES video(vid_id),
    FOREIGN KEY (emp_id) REFERENCES emp_details(emp_id),
  FOREIGN KEY (created_by) REFERENCES emp_details(emp_id),
    FOREIGN KEY (updated_by) REFERENCES emp_details(emp_id)
);
